import React, { useEffect, useState } from 'react';
import './heros.css';
import sparkle from './sparkle.png';
import axios from 'axios';
import { useNavigate } from 'react-router-dom';


const Herosection = () => {
  const [isTrialActive, setIsTrialActive] = useState(false)
  const [isSubscribed, setIsSubscribed] = useState(false)
  const accessToken = localStorage.getItem("accessToken")


  
  useEffect(() => {
    // Fetch user subscription information only if accessToken is available
    if (accessToken) {
      axios.get('https://stream.xircular.io/api/v1/subscription/getCustomerSubscription', {
        headers:{
          authorization:accessToken
        }
      })
      .then(response => {
        const user = response.data[0]; // Adjust based on the actual response structure
          console.log(user);
          setIsSubscribed(user.isSubscribed);
          setIsTrialActive(user.isTrialActive);
      })
      .catch(error => {
        console.error("Error fetching user subscription data", error);
      });
    }
  }, [accessToken]);
  
   const navigate = useNavigate()
   const createfreetrail = async () => {
      if (accessToken) {
        try {
          const createfreetrailurl =
            "https://stream.xircular.io/api/v1/customer/startTrial";
          const response = await axios.get(createfreetrailurl, {
        headers:{
          authorization:accessToken
        }
          });
  
          console.log("Free Trial Response", response);
          // setData(response.data.data);
          // window.location.href = `https://new-video-editor.vercel.app/listings?accessToken=${accessToken}`;
          navigate("/listings")
        } catch (error) {
          if(error.response.data.message==="jwt expired"){
            alert("Session expired, please login again to continue")
            navigate("/SignIn")
          }
          console.log("Error fetching data:", error);
        }
      } else {
        navigate("/SignUp");
      }
    };

  return (
     <div className='herosection container' >
        <div  className='contentpart' >

            <div className='heropart'>
                 <h1><strong id="aipart"> Ai </strong> Engage </h1>
                 <img src={sparkle} alt="Interactive Video survey campaigns" />
            </div>
                
                <h2> Unveiling the Future of Surveys </h2>
                <h3> Engage, Analyze, Evolve!  Revolutionize your Surveys with Interactive Video Campaigns and AI. </h3>
              
                <button id="freetrailbtn"
                onClick={isTrialActive||isSubscribed?()=>{window.location.href = `https://new-video-editor.vercel.app/listings?accessToken=${accessToken}`}:createfreetrail}
                > 
                {/* <svg xmlns="http://www.w3.org/2000/svg" width="46" height="33" viewBox="0 0 46 33" fill="none">
                <path d="M16.0897 30.528L18.2817 31.9937C19.9787 33.1282 21.7364 32.9422 23.0395 32.0722C23.5379 31.7387 23.9648 31.308 24.295 30.8055C24.7712 30.0865 25.0352 29.2338 25.0309 28.368C25.4839 28.4228 25.9427 28.4051 26.3903 28.3158C28.7368 27.8466 30.2231 25.5894 29.6286 23.2317C29.5699 22.9988 29.4927 22.771 29.3977 22.5505C30.1553 22.7161 30.9259 22.6972 31.6402 22.5113C32.7875 22.2105 33.7933 21.4814 34.3922 20.3789C35.626 18.11 34.6129 15.3399 32.4123 14.1299C30.086 12.8473 29.7729 12.7136 29.4583 12.5785C29.2259 12.4783 28.9951 12.3781 27.6112 11.6257L40.8571 11.6111C41.2208 11.6111 41.4662 11.6213 41.8414 11.5792C42.9064 11.4586 43.8674 10.9909 44.5918 10.3038C46.4678 8.5244 46.4664 5.63527 44.5861 3.85873C43.8342 3.14696 42.8327 2.67491 41.723 2.57611C41.446 2.55143 41.2598 2.55721 40.9971 2.55721L25.6039 2.57322C23.2632 2.57322 23.7538 1.54768 21.1592 1.10899C19.2154 0.779318 16.9107 0.690729 14.661 0.892582C12.5887 1.07853 10.5569 1.51134 8.88439 2.22745C5.93037 3.49416 3.66766 5.48567 2.16246 7.85909C0.947495 9.77656 0.230229 11.9336 0.0469366 14.1503C-0.136352 16.3668 0.214333 18.6474 1.12926 20.8147C2.29959 23.579 4.39355 26.1456 7.48605 28.1327C10.3303 29.9586 11.9105 30.2695 14.9957 30.8738L15.0608 30.8869C15.4562 30.9638 15.8429 30.8142 16.0897 30.528Z" fill="black"/>
                <path d="M15.4885 20.9907C15.7651 20.9864 16.0415 21.0104 16.3133 21.0624C16.5279 21.1009 16.7252 20.9338 16.7168 20.7115C16.6574 19.2708 17.4236 17.9636 18.6676 17.274C18.6938 17.2592 18.7186 17.241 18.7412 17.2189C18.8059 17.1553 18.843 17.0685 18.8442 16.9775C18.8455 16.8865 18.8107 16.7987 18.7477 16.7335C18.2759 16.2447 17.8684 15.5399 17.6121 14.9149C17.5852 14.8496 17.539 14.7943 17.4798 14.7563C17.4036 14.7075 17.3113 14.6911 17.2231 14.7108C17.135 14.7304 17.0582 14.7845 17.0097 14.8612C16.1194 16.2688 15.0688 16.2993 13.0829 16.3552L12.7175 16.3672C12.5197 16.3729 12.3278 16.2996 12.1837 16.1631C11.7054 15.7109 11.9973 14.8899 12.6627 14.8614L13.0346 14.8508C16.0108 14.7661 16.5343 12.7335 16.944 11.1416C17.1856 10.203 17.3765 9.4624 18.1532 9.69671C18.3408 9.75291 18.4991 9.88078 18.5942 10.053C18.6894 10.225 18.714 10.4278 18.6625 10.6178C18.3606 12.2356 18.5883 14.0308 19.5687 15.388H19.5701C20.5102 16.6869 21.8361 17.0724 23.3461 16.902C24.1216 16.8142 24.4967 16.4768 24.6682 15.9619C24.8182 15.5112 24.7796 14.9639 24.7345 14.3327C24.6521 13.1536 24.6719 11.9071 24.6919 10.6534C24.7185 8.97969 24.7456 7.29255 24.537 5.73223C24.4832 5.32681 24.3703 4.96062 24.206 4.63492C23.1551 2.54868 19.9027 2.4441 17.9054 2.37757C13.7344 2.2379 9.3189 2.88143 6.08227 5.7354C5.0154 6.67641 4.1302 7.75881 3.4361 8.85332C0.367581 13.6997 1.19414 19.539 4.93475 23.8036C7.14753 26.3264 9.6598 27.8654 12.8476 28.7281C13.1819 28.8165 13.424 28.4004 13.1763 28.1526C11.8283 26.8051 11.4263 24.6855 12.3085 22.9533C12.9549 21.6838 14.122 21.0129 15.4885 20.9907Z" fill="#FCC9B6"/>
                <path d="M14.8042 18.9262C15.0768 18.9219 16.0368 21.0088 16.3124 21.0615C16.3375 21.0661 16.363 21.0678 16.3885 21.0668C16.4788 21.0633 16.564 21.0237 16.6254 20.9569C16.6868 20.8901 16.7194 20.8015 16.7159 20.7106C16.6565 19.2699 17.4226 17.9626 18.6667 17.2731C18.6929 17.2583 18.7177 17.2401 18.7403 17.218C18.805 17.1544 18.8421 17.0676 18.8433 16.9766C18.8445 16.8856 18.8098 16.7978 18.7468 16.7325C18.275 16.2438 17.8675 15.539 17.6112 14.914C17.5843 14.8487 17.5381 14.7934 17.4789 14.7554C17.4027 14.7066 17.3104 14.6902 17.2222 14.7099C17.1341 14.7295 17.0573 14.7836 17.0087 14.8603C16.1185 16.2679 15.0679 16.2984 13.082 16.3543L12.7165 16.3663C12.5188 16.372 12.3269 16.2987 12.1828 16.1622C11.7045 15.71 11.9964 14.889 12.6618 14.8605L13.0337 14.8499C16.0099 14.7652 16.5334 12.7326 16.9431 11.1407C17.1847 10.2021 17.3756 9.46149 18.1523 9.6958C18.3399 9.752 18.4982 9.87987 18.5932 10.052C18.6885 10.2241 18.7131 10.4269 18.6616 10.6169C18.3597 12.2347 18.5874 12.6542 19.5678 14.0114H19.5692C20.5093 15.3103 21.4936 15.6958 23.0035 15.5254C23.779 15.4375 24.1541 15.1003 24.3256 14.5853C24.4757 14.1347 24.4371 13.5873 24.392 12.9561C24.3095 11.7771 24.3293 11.9062 24.3493 10.6525C24.3759 8.97878 24.403 7.29164 24.1944 5.73133C24.1407 5.3259 24.0278 4.95971 23.8634 4.63401C22.8126 2.54778 19.9018 2.44319 17.9045 2.37666C13.7335 2.237 10.6847 2.88052 7.448 5.73449C6.38122 6.67551 5.49593 7.7579 4.80192 8.85241C0.54628 15.5738 5.09567 25.1207 10.7966 26.6637C11.131 26.7521 11.3731 26.336 11.1253 26.0881C9.77726 24.7407 10.742 22.621 11.6243 20.8887C12.2707 19.6193 13.4378 18.9484 14.8042 18.9262Z" fill="#FEDECF"/>
                <path d="M16.9114 22.7842C15.73 22.0672 14.104 22.3827 13.3589 23.5855C12.5485 24.8937 13.2073 26.4832 14.3893 27.2779C15.7952 28.2624 17.9558 29.8738 19.3836 30.6643C20.4467 31.3754 21.7209 31.3166 22.6328 30.3987C22.761 30.269 22.8761 30.127 22.9767 29.9747C23.4852 28.9976 23.6424 28.1926 22.994 27.2047C22.8425 26.9862 19.1872 24.4648 18.6527 24.084C18.5297 23.9884 18.4066 23.9045 18.286 23.8025C17.7936 23.3509 17.495 23.1749 16.9114 22.7842Z" fill="#FCC9B6"/>
                <path d="M16.9109 22.7834C15.7296 22.0664 14.1036 22.3819 13.3585 23.5847C12.5481 24.893 13.8901 25.7945 15.0722 26.5893C16.4782 27.5738 18.6388 29.1851 20.0666 29.9757C21.2136 30.7428 21.8439 30.3985 22.5428 29.857C23.0514 28.88 23.2085 28.075 22.5602 27.0871C22.4087 26.8686 19.1868 24.464 18.6522 24.0832C18.5292 23.9877 18.4061 23.9037 18.2855 23.8017C17.7932 23.3501 17.4945 23.1741 16.9109 22.7834Z" fill="#FEDECF"/>
                <path d="M18.8714 22.3957L22.625 24.9043C22.8647 25.0649 23.1106 25.2626 23.3344 25.4666C23.4696 25.5901 24.1717 26.3783 24.3115 26.3783C25.4208 27.0914 26.9707 26.8234 27.7349 25.7406C28.6076 24.5114 27.9931 22.8868 26.863 22.0794C25.5106 21.0515 23.4592 19.5164 22.045 18.6521C22.0152 18.6308 21.9837 18.6082 21.9452 18.5859C19.6122 17.1076 16.7997 19.8652 18.7818 22.3086C18.8061 22.343 18.8365 22.3725 18.8714 22.3957Z" fill="#FCC9B6"/>
                <path d="M19.5546 21.7064L23.3082 24.2149C23.548 24.3755 23.7939 24.5732 24.0176 24.7773C24.1528 24.9008 24.8549 25.6889 24.9948 25.6889C26.104 26.402 26.657 26.6395 27.4211 25.5568C28.2939 24.3276 27.6794 22.7029 26.5492 21.8955C25.1969 20.8676 23.4591 19.5149 22.0449 18.6506C22.0151 18.6293 21.9836 18.6067 21.9451 18.5844C19.6121 17.1061 17.483 19.1759 19.465 21.6193C19.4893 21.6536 19.5197 21.6831 19.5546 21.7064Z" fill="#FEDECF"/>
                <path d="M31.6702 15.8914C31.0071 15.5267 30.3452 15.1596 29.6845 14.7903C28.9657 14.3884 28.2517 14.0645 27.5275 13.6795C27.4765 13.6525 27.4196 13.6389 27.362 13.6401C27.3044 13.6412 27.248 13.657 27.1981 13.686C27.1483 13.715 27.1065 13.7563 27.0767 13.8059C27.047 13.8556 27.0302 13.912 27.0279 13.9699C26.9641 15.5172 26.4491 16.9556 25.1988 17.8968C25.1502 17.9299 25.1109 17.9752 25.0848 18.028C25.0586 18.0809 25.0464 18.1397 25.0494 18.1987C25.0524 18.2578 25.0704 18.315 25.1018 18.3649C25.1331 18.4149 25.1767 18.4559 25.2284 18.4839L29.1013 20.5841C30.4028 21.2686 32.1479 21.0086 32.9019 19.6517L32.9134 19.6323C33.6548 18.2708 32.971 16.6092 31.6702 15.8914Z" fill="#FCC9B6"/>
                <path d="M31.6702 15.8915C31.0071 15.5267 30.3452 15.1596 29.6845 14.7903C28.9657 14.3884 28.2517 14.0645 27.5275 13.6795C27.4765 13.6525 27.4196 13.6389 27.362 13.6401C27.3044 13.6412 27.248 13.6571 27.1981 13.6861C27.1483 13.7151 27.1065 13.7563 27.0767 13.8059C27.047 13.8556 27.0302 13.912 27.0279 13.9699C26.9641 15.5172 27.1324 16.2678 25.8821 17.209C25.8335 17.2421 25.7942 17.2873 25.768 17.3402C25.7419 17.3931 25.7297 17.4519 25.7327 17.511C25.7357 17.57 25.7537 17.6272 25.7851 17.6772C25.8165 17.7271 25.8601 17.7681 25.9118 17.7961L29.7847 19.8963C31.0862 20.5807 32.1479 21.0086 32.9019 19.6517L32.9134 19.6323C33.6548 18.2709 32.971 16.6092 31.6702 15.8915Z" fill="#FEDECF"/>
                <path d="M44.4311 7.08098C44.4283 5.37929 43.2596 4.12903 41.5535 4.13192L26.4127 4.14647C26.3224 4.1465 26.2358 4.18263 26.1719 4.24693C26.108 4.31122 26.0721 4.39842 26.0721 4.48934L26.0763 9.70986C26.0764 9.80078 26.1123 9.88797 26.1762 9.95226C26.24 10.0165 26.3266 10.0527 26.417 10.0527L41.5607 10.0382C43.2576 10.0353 44.434 8.78828 44.4311 7.08098Z" fill="#FCC9B6"/>
                <path d="M43.405 7.08346C43.4022 5.38177 42.2334 4.13151 40.5273 4.1344L26.4116 4.14895C26.3213 4.14898 26.2347 4.18511 26.1708 4.2494C26.1069 4.3137 26.071 4.4009 26.071 4.49182L26.0752 8.68057C26.0753 8.77149 26.1112 8.85867 26.1751 8.92296C26.2389 8.98725 26.3255 9.02339 26.4159 9.02344L40.5346 9.00889C42.2315 9.00599 43.4078 8.79076 43.405 7.08346Z" fill="#FEDECF"/>
                </svg> */}
                
                   {isTrialActive || isSubscribed ?"Go to dashboard":"Start your free trial today "}
                
                </button>

            </div>
     </div>
  )
}

export default Herosection